<!DOCTYPE HTML>
<html>

<head>
</head>
<link rel="stylesheet" href="stylesheet.css" />
<meta charset="UTF-8">

<body onload="createShoppingList(); getSuggestions()">
    <form id="input">
        <p><label for="produkt"> Produkt :</label>
            <input id="produkt" type="text" required></p>
        <p><label for="antall"> Antall :</label>
            <input id="antall" type="number"> Enhet: <input id="enhet" type="enhet"></p>

    </form>
    <button id="leggTil" onclick="addElement()">Legg Til</button>
    <p id="handleliste"></p>
    <p id="side2"></p>
    <p id="forslag"></p>

    <script>
        let shoppingList = [];
        let secondPage = [];
        let numOfWares = 0;
        let secondPageItems = 0;
        let totalWares = 0;

        function getSuggestions() {
            const xhr = new XMLHttpRequest();
            xhr.onreadystatechange = () => {
                if (xhr.readyState === XMLHttpRequest.DONE) {
                    document.getElementById("forslag").innerHTML = xhr.responseText;
                    return xhr.responseText;
                }
            }
            xhr.open("GET", "suggestions.txt");
        }

        function createShoppingList() {
            let shoppingText = "<ul id='nyHandleliste'>";
            for (let i of shoppingList) {
                let index = shoppingList.indexOf(i);
                shoppingText += "<li>" + i + "<a onclick='removeElement(" + index + ")'> &times;</a></li>";
            }
            shoppingText += "</ul>";
            document.getElementById("handleliste").innerHTML = shoppingText;
        }

        function shoppingListSecondPage() {
            let shoppingText = "<ul id='listeAndreSide'>";
            for (let i of secondPage) {
                let index = secondPage.indexOf(i);
                shoppingText += "<li><a onclick='removeSecondPageElement(" + index + ")'>&times;</a>" + i + "</li>";
            }
            shoppingText += "</ul>";
            document.getElementById("side2").innerHTML = shoppingText;
        }

        function addElement() {
            if (document.getElementById("produkt").value != "") {
                let text = document.getElementById("antall").value + " " +
                    document.getElementById("enhet").value + " " +
                    document.getElementById("produkt").value;
                if (numOfWares <= 9) {
                    shoppingList.push(text);
                    createShoppingList();
                    numOfWares++;
                }
                else if (numOfWares >= 10) {
                    secondPage.push(text);
                    shoppingListSecondPage();
                    secondPageItems++;
                }
                document.getElementById("antall").value = "";
                document.getElementById("enhet").value = "";
                document.getElementById("produkt").value = "";
            }
        }

        function removeElement(index) {
            shoppingList.splice(index, 1);
            let updatedList = document.getElementById("nyHandleliste");
            updatedList.removeChild(updatedList.childNodes[index]);
            numOfWares--;
            createShoppingList();
        }

        function removeSecondPageElement(index) {
            secondPage.splice(index, 1);
            let updatedList = document.getElementById("listeAndreSide");
            updatedList.removeChild(updatedList.childNodes[index]);
            secondPageItems--;
            shoppingListSecondPage();
        }
    </script>
</body>

</html>