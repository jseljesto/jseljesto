<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="stylesheet.css" />
    <meta charset="UTF-8">
</head>

<body onkeydown="moveObject(event)">
    <canvas onclick="showCoords()" id="myCanvas" width="800" height="500"></canvas>
    <img id="objectImage" src="./image.png" style="opacity: 0"/>
    <img id="finishLine" src="./finishline.png" style="opacity: 0"/>
    <h1 id="timer" style="position: fixed; left: 10%">00:00:00</h1>
    <script>

        let wallsLeft = [];
        let wallsRight = [];
        let wallsUp = [];
        let wallsDown = [];

        let c = document.getElementById("myCanvas");
        let ctx = c.getContext("2d");
        let currentX = 125;
        let currentY = 425;
        let objImage = document.getElementById("objectImage");
        let seconds = 0;
        let minutes = 0;
        let hours = 0;

        //Creating lines for maze

        function drawMaze() {
            wallsLeft = [];
            wallsRight = [];
            wallsUp = [];
            wallsDown = [];

            ctx.beginPath();
            ctx.rect(0, 0, 500, 500);
            ctx.stroke();

            ctx.beginPath();
            ctx.moveTo(400, 500);
            ctx.lineTo(400, 400);
            ctx.stroke();
            wallsLeft.push([425, 425]);
            wallsRight.push([325, 425]);

            ctx.beginPath();
            ctx.moveTo(500, 300);
            ctx.lineTo(400, 300);
            ctx.stroke();
            wallsUp.push([425, 325]);
            wallsDown.push([425, 225]);

            ctx.beginPath();
            ctx.moveTo(500, 200);
            ctx.lineTo(200, 200);
            ctx.stroke();
            wallsUp.push([425, 225]);
            wallsUp.push([325, 225]);
            wallsUp.push([225, 225]);
            wallsDown.push([425, 125]);
            wallsDown.push([325, 125]);
            wallsDown.push([225, 125]);

            ctx.beginPath();
            ctx.moveTo(400, 0);
            ctx.lineTo(400, 100);
            wallsLeft.push([425, 25]);
            wallsRight.push([325, 25]);
            ctx.moveTo(400, 100);
            ctx.lineTo(100, 100);
            wallsUp.push([325, 125]);
            wallsUp.push([225, 125]);
            wallsUp.push([125, 125]);
            wallsDown.push([325, 25]);
            wallsDown.push([225, 25]);
            wallsDown.push([125, 25]);
            ctx.moveTo(100, 100);
            ctx.lineTo(100, 200);
            ctx.stroke();
            wallsRight.push([25, 125]);
            wallsLeft.push([125, 125]);

            ctx.beginPath();
            ctx.moveTo(300, 500);
            ctx.lineTo(300, 300);
            wallsLeft.push([325, 325]);
            wallsLeft.push([325, 425]);
            wallsRight.push([225, 325]);
            wallsRight.push([225, 425]);
            ctx.moveTo(300, 300);
            ctx.lineTo(100, 300);
            ctx.stroke();
            wallsUp.push([225, 325]);
            wallsUp.push([125, 325]);
            wallsDown.push([225, 225]);
            wallsDown.push([125, 225]);

            ctx.beginPath();
            ctx.moveTo(100, 500);
            ctx.lineTo(100, 400);
            wallsLeft.push([125, 425]);
            wallsRight.push([25, 425]);
            ctx.moveTo(100, 400);
            ctx.lineTo(200, 400);
            ctx.stroke();
            wallsDown.push([125, 325]);
            wallsUp.push([125, 425]);

            createFinishLine();
            createImage(currentX, currentY);
            checkFinish();
        }

        function createImage(x, y) {
            ctx.drawImage(objImage, x, y);
        }

        function createFinishLine() {
            let finishLine = document.getElementById("finishLine");
            ctx.drawImage(finishLine, 300, 0);
        }

        function moveLeft() {
            let foundWall = false;
            let temp = [];
            temp.push([currentX, currentY]);
            let i = 0;
            while (i <= wallsLeft.length && foundWall === false) {
                if (JSON.stringify(temp[0]) === JSON.stringify(wallsLeft[i])) {
                    foundWall = true;
                }
                i++;
            }
            if (foundWall === false && currentX != 25) {
                currentX -= 100;
                ctx.clearRect(0, 0, c.width, c.height);
                drawMaze();
            }
        }

        function moveRight() {
            let foundWall = false;
            let temp = [];
            temp.push([currentX, currentY]);
            let i = 0;
            while (i <= wallsRight.length && foundWall === false) {
                if (JSON.stringify(temp[0]) === JSON.stringify(wallsRight[i])) {
                    foundWall = true;
                }
                i++;
            }
            if (foundWall === false && currentX != 425) {
                currentX += 100;
                ctx.clearRect(0, 0, c.width, c.height);
                drawMaze();
            }
        }

        function moveUp() {
            let foundWall = false;
            let temp = [];
            temp.push([currentX, currentY]);
            let i = 0;
            while (i <= wallsUp.length && foundWall === false) {
                if (JSON.stringify(temp[0]) === JSON.stringify(wallsUp[i])) {
                    foundWall = true;
                }
                i++;
            }
            if (foundWall === false && currentY != 25) {
                currentY -= 100;
                ctx.clearRect(0, 0, c.width, c.height);
                drawMaze();
            }
        }

        function moveDown() {
            let foundWall = false;
            let temp = [];
            temp.push([currentX, currentY]);
            let i = 0;
            while (i <= wallsDown.length && foundWall === false) {
                if (JSON.stringify(temp[0]) === JSON.stringify(wallsDown[i])) {
                    foundWall = true;
                }
                i++;
            }
            if (foundWall === false && currentY != 425) {
                currentY += 100;
                ctx.clearRect(0, 0, c.width, c.height);
                drawMaze();
            }
        }

        function moveObject(event) {
            switch (event.keyCode) {
                case 37:
                    moveLeft();
                    break;
                case 38:
                    moveUp();
                    break;
                case 39:
                    moveRight();
                    break;
                case 40:
                    moveDown();
                    break;
            }
        }

        function timerCount() {
            seconds++;
            if (seconds >= 60) {
                seconds = 0;
                minutes++;
                if (minutes >= 60) {
                    minutes = 0;
                    hours++;
                }
            }

            if (hours < 10) {
                document.getElementById("timer").innerHTML = "0" + hours + ":";
            } else {
                document.getElementbyId("timer").innerHTML = hours + ":";
            }

            if (minutes < 10) {
                document.getElementById("timer").innerHTML += "0" + minutes + ":";
            } else {
                document.getElementById("timer").innerHTML += minutes + ":";
            }

            if (seconds < 10) {
                document.getElementById("timer").innerHTML += "0" + seconds;
            } else {
                document.getElementById("timer").innerHTML += seconds;
            }
        }

        function showCoords() {
            var x = event.screenX - 400;
            var y = event.screenY - 120;
            alert("X-coords: " + x + " Y-coords: " + y);
        }

        function checkFinish() {
            if (currentX === 325 && currentY === 25) {
                alert("Congrats! You reached the finish line in " + hours + " hours, "
                    + minutes + " minutes and " + seconds + " seconds!");
                window.location.reload();
            }
        }

        drawMaze();
        createImage(currentX, currentY);
        createFinishLine();
        setInterval(timerCount, 1000);

    </script>
</body>

</html>